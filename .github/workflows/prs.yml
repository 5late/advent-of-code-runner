name: Run tests
on: [push]
jobs:
  run-day-1:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with: 
          node-verison: 16
      - run: |
        apt-get update && apt-get install -yqq --no-install-recommends build-essential git wget ca-certificates curl unzip ninja-build ccache;
      - run: |
        apt remove --purge --auto-remove cmake; 
        apt update; 
        apt install -y software-properties-common lsb-release; 
        apt clean all; 
        wget -O - https://apt.kitware.com/keys/kitware-archive-latest.asc 2>/dev/null | gpg --dearmor - | sudo tee /etc/apt/trusted.gpg.d/kitware.gpg >/dev/null; 
        apt-add-repository "deb https://apt.kitware.com/ubuntu/ $(lsb_release -cs) main"; 
        apt update; 
        apt install cmake;

      - run: |
        apt-get update && apt-get install -yqq --no-install-recommends \
        cargo openjdk-17-jdk golang nodejs php-cli python3 ruby rustc;
        rm -rf /var/lib/apt/lists/*;
        apt-get autoremove -yqq;

      - run: |
        make test YEAR=2021 DAY=1;
        make test YEAR=2021 DAY=2;